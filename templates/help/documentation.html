{% extends 'base.html' %}
{% load static %}

{% block title %}Documentation - Cargo Tracking MIS{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
<style>
    :root {
        --primary-color: #4e73df;
        --primary-hover: #2e59d9;
        --success-color: #1cc88a;
        --warning-color: #f6c23e;
        --danger-color: #e74a3b;
        --info-color: #36b9cc;
        --light-bg: #f8f9fc;
        --border-color: #e3e6f0;
        --text-muted: #858796;
    }
    
    .breadcrumb-custom {
        padding: 15px 20px;
        margin-bottom: 20px;
        font-size: 0.9rem;
    }
    
    .documentation-container {
        background: white;
        border-radius: 8px;
        box-shadow: 0 0.15rem 1.75rem 0 rgba(58, 59, 69, 0.15);
        overflow: hidden;
        margin-bottom: 30px;
    }
    
    .doc-header {
        background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-hover) 100%);
        color: white;
        padding: 30px;
        text-align: center;
    }
    
    .doc-layout {
        display: flex;
        min-height: 600px;
    }
    
    .doc-sidebar {
        background: var(--light-bg);
        border-right: 1px solid var(--border-color);
        width: 300px;
        padding: 0;
    }
    
    .doc-content {
        flex: 1;
        padding: 30px;
        min-height: 600px;
    }
    
    .tabs-vertical {
        padding: 20px 0;
    }
    
    .tab-vertical {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 15px 25px;
        color: #5a5c69;
        text-decoration: none;
        border-left: 3px solid transparent;
        transition: all 0.3s ease;
        cursor: pointer;
        border: none;
        background: none;
        width: 100%;
        text-align: left;
    }
    
    .tab-vertical:hover {
        background-color: rgba(78, 115, 223, 0.1);
        color: var(--primary-color);
    }
    
    .tab-vertical.active {
        background-color: rgba(78, 115, 223, 0.1);
        color: var(--primary-color);
        border-left-color: var(--primary-color);
        font-weight: 600;
    }
    
    .tab-vertical i {
        font-size: 1.1rem;
        width: 20px;
    }
    
    .tab-content {
        display: none;
        animation: fadeIn 0.3s ease;
    }
    
    .tab-content.active {
        display: block;
    }
    
    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
    }
    
    .doc-section {
        margin-bottom: 40px;
    }
    
    .doc-section h2 {
        color: var(--primary-color);
        border-bottom: 2px solid var(--border-color);
        padding-bottom: 10px;
        margin-bottom: 20px;
        display: flex;
        align-items: center;
        gap: 10px;
    }
    
    .doc-section h3 {
        color: #5a5c69;
        margin-top: 25px;
        margin-bottom: 15px;
        display: flex;
        align-items: center;
        gap: 8px;
    }
    
    .feature-card {
        background: var(--light-bg);
        border-radius: 8px;
        padding: 20px;
        margin-bottom: 15px;
        transition: transform 0.2s ease;
    }
    
    .feature-card:hover {
        transform: translateY(-2px);
    }
    
    .feature-card h5 {
        color: var(--primary-color);
        margin-bottom: 10px;
        display: flex;
        align-items: center;
        gap: 8px;
    }
    
    .step-card {
        background: white;
        border: 1px solid var(--border-color);
        border-radius: 8px;
        padding: 20px;
        margin-bottom: 15px;
        position: relative;
    }
    
    .step-number {
        position: absolute;
        top: -10px;
        left: 20px;
        background: var(--primary-color);
        color: white;
        width: 30px;
        height: 30px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        font-size: 0.9rem;
    }
    
    .code-block {
        background: #2d3748;
        color: #e2e8f0;
        padding: 15px;
        border-radius: 6px;
        font-family: 'Courier New', monospace;
        margin: 15px 0;
        overflow-x: auto;
    }
    
    .contact-support {
        background: linear-gradient(135deg, #f8f9fc 0%, #e9ecef 100%);
        border-radius: 8px;
        padding: 25px;
        text-align: center;
        margin-top: 30px;
    }
    
    .search-box {
        position: relative;
        margin-bottom: 20px;
        padding: 0 25px;
    }
    
    .search-box input {
        padding-left: 40px;
        border-radius: 6px;
        border: 1px solid var(--border-color);
    }
    
    .search-box i {
        position: absolute;
        left: 40px;
        top: 50%;
        transform: translateY(-50%);
        color: var(--text-muted);
    }
    
    .quick-links {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
        margin: 25px 0;
    }
    
    .quick-link-card {
        background: white;
        border: 1px solid var(--border-color);
        border-radius: 8px;
        padding: 20px;
        text-align: center;
        transition: all 0.3s ease;
        text-decoration: none;
        color: inherit;
    }
    
    .quick-link-card:hover {
        border-color: var(--primary-color);
        transform: translateY(-2px);
        text-decoration: none;
        color: inherit;
    }
    
    .quick-link-card i {
        font-size: 2rem;
        color: var(--primary-color);
        margin-bottom: 10px;
    }
    
    .table-responsive {
        border-radius: 8px;
        overflow: hidden;
        box-shadow: 0 0.15rem 1.75rem 0 rgba(58, 59, 69, 0.1);
    }
    
    .table th {
        background: var(--light-bg);
        font-weight: 600;
        color: #5a5c69;
        border-bottom: 2px solid var(--border-color);
    }
    
    .badge {
        display: inline-flex;
        align-items: center;
        gap: 4px;
        padding: 6px 12px;
        border-radius: 12px;
        font-weight: 600;
        font-size: 12px;
    }
    
    .badge-warning { background: #fef3c7; color: #92400e; }
    .badge-info { background: #dbeafe; color: #1e40af; }
    .badge-primary { background: #e0e7ff; color: #3730a3; }
    .badge-success { background: #dcfce7; color: #166534; }
    .badge-danger { background: #fee2e2; color: #991b1b; }
    
    .capacity-bar {
        height: 8px;
        background-color: #e9ecef;
        border-radius: 4px;
        overflow: hidden;
        margin: 5px 0;
    }
    
    .capacity-fill {
        height: 100%;
        border-radius: 4px;
    }
    
    .capacity-low { background-color: var(--success-color); }
    .capacity-medium { background-color: var(--warning-color); }
    .capacity-high { background-color: var(--danger-color); }
    
    @media (max-width: 768px) {
        .doc-layout {
            flex-direction: column;
        }
        
        .doc-sidebar {
            width: 100%;
            border-right: none;
            border-bottom: 1px solid var(--border-color);
        }
        
        .tabs-vertical {
            display: flex;
            overflow-x: auto;
            padding: 15px;
        }
        
        .tab-vertical {
            flex: 0 0 auto;
            border-left: none;
            border-bottom: 3px solid transparent;
            padding: 10px 15px;
        }
        
        .tab-vertical.active {
            border-left: none;
            border-bottom-color: var(--primary-color);
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="container-fluid py-4">
    <!-- Breadcrumb -->
    <div class="breadcrumb-custom">
        <a href="{% url 'dashboard' %}"><i class="bi bi-house-door"></i> Home</a>
        <span>/</span>
        <a href="{% url 'help_page' %}">Help</a>
        <span>/</span>
        <span>Documentation</span>
    </div>
    
    <!-- Documentation Container -->
    <div class="documentation-container">
        <!-- Header -->
        <div class="doc-header">
            <h1 class="h2 mb-3"><i class="bi bi-file-text me-2"></i>System Documentation</h1>
            <p class="mb-0">Complete guide to using the Cargo Tracking Management Information System</p>
        </div>
        
        <div class="doc-layout">
            <!-- Sidebar Navigation with Vertical Tabs -->
            <div class="doc-sidebar">
                <div class="search-box">
                    <i class="bi bi-search"></i>
                    <input type="text" class="form-control" placeholder="Search documentation..." id="docSearch">
                </div>
                
                <div class="tabs-vertical">
                    <button class="tab-vertical active" data-tab="getting-started">
                        <i class="bi bi-play-circle"></i>
                        <span>Getting Started</span>
                    </button>
                    <button class="tab-vertical" data-tab="cargo-tracking">
                        <i class="bi bi-box-seam"></i>
                        <span>Cargo Tracking</span>
                    </button>
                    <button class="tab-vertical" data-tab="supplier-management">
                        <i class="bi bi-truck"></i>
                        <span>Supplier Management</span>
                    </button>
                    <button class="tab-vertical" data-tab="warehouse-management">
                        <i class="bi bi-building"></i>
                        <span>Warehouse Management</span>
                    </button>
                    <button class="tab-vertical" data-tab="reports-analytics">
                        <i class="bi bi-graph-up"></i>
                        <span>Reports & Analytics</span>
                    </button>
                    <button class="tab-vertical" data-tab="alerts-notifications">
                        <i class="bi bi-bell"></i>
                        <span>Alerts & Notifications</span>
                    </button>
                    <button class="tab-vertical" data-tab="user-management">
                        <i class="bi bi-people"></i>
                        <span>User Management</span>
                    </button>
                    <button class="tab-vertical" data-tab="troubleshooting">
                        <i class="bi bi-tools"></i>
                        <span>Troubleshooting</span>
                    </button>
                </div>
            </div>
            
            <!-- Main Content -->
            <div class="doc-content">
                <!-- Quick Links -->
                <div class="quick-links">
                    <a href="#" class="quick-link-card" data-tab="cargo-tracking">
                        <i class="bi bi-box-seam"></i>
                        <h6>Track Cargo</h6>
                        <small>Monitor shipments in real-time</small>
                    </a>
                    <a href="#" class="quick-link-card" data-tab="supplier-management">
                        <i class="bi bi-truck"></i>
                        <h6>Manage Suppliers</h6>
                        <small>Supplier performance tracking</small>
                    </a>
                    <a href="#" class="quick-link-card" data-tab="reports-analytics">
                        <i class="bi bi-graph-up"></i>
                        <h6>View Reports</h6>
                        <small>Analytics and insights</small>
                    </a>
                    <a href="#" class="quick-link-card" data-tab="alerts-notifications">
                        <i class="bi bi-bell"></i>
                        <h6>Set Alerts</h6>
                        <small>Stay informed</small>
                    </a>
                </div>
                
                <!-- Getting Started Tab -->
                <div class="tab-content active" id="getting-started">
                    <div class="doc-section">
                        <h2><i class="bi bi-play-circle"></i>Getting Started</h2>
                        
                        <div class="feature-card">
                            <h5><i class="bi bi-info-circle"></i>Welcome to Cargo Tracking MIS</h5>
                            <p class="mb-0">This comprehensive system helps you manage cargo shipments, track supplier performance, and optimize warehouse operations across Kenya.</p>
                        </div>
                        
                        <h3><i class="bi bi-grid"></i>System Overview</h3>
                        <p>The Cargo Tracking Management Information System provides:</p>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <ul>
                                    <li>Real-time cargo tracking and monitoring</li>
                                    <li>Supplier performance analytics</li>
                                    <li>Warehouse capacity management</li>
                                    <li>Automated alerts and notifications</li>
                                </ul>
                            </div>
                            <div class="col-md-6">
                                <ul>
                                    <li>Comprehensive reporting</li>
                                    <li>Multi-county operations support</li>
                                    <li>Quality control tracking</li>
                                    <li>Audit trail and history</li>
                                </ul>
                            </div>
                        </div>
                        
                        <h3><i class="bi bi-lightning"></i>Quick Start Guide</h3>
                        
                        <div class="step-card">
                            <div class="step-number">1</div>
                            <h5>Add Your First Supplier</h5>
                            <p>Navigate to Suppliers → New Supplier to add your first supplier with their KRA PIN and contact information.</p>
                        </div>
                        
                        <div class="step-card">
                            <div class="step-number">2</div>
                            <h5>Set Up Warehouses</h5>
                            <p>Go to Warehouses → New Warehouse to configure your storage facilities with capacity details.</p>
                        </div>
                        
                        <div class="step-card">
                            <div class="step-number">3</div>
                            <h5>Track Your First Cargo</h5>
                            <p>Create a new cargo shipment from Cargo Tracking → New Cargo to start monitoring deliveries.</p>
                        </div>
                    </div>
                </div>
                
                <!-- Cargo Tracking Tab -->
                <div class="tab-content" id="cargo-tracking">
                    <div class="doc-section">
                        <h2><i class="bi bi-box-seam"></i>Cargo Tracking</h2>
                        
                        <p>Track and monitor all cargo shipments from dispatch to final delivery with real-time status updates.</p>
                        
                        <h3><i class="bi bi-plus-circle"></i>Creating a New Cargo Shipment</h3>
                        <div class="step-card">
                            <div class="step-number">1</div>
                            <p>Click <strong>"New Cargo"</strong> from the Cargo Tracking page</p>
                        </div>
                        <div class="step-card">
                            <div class="step-number">2</div>
                            <p>Fill in the cargo details including description, quantity, and declared value</p>
                        </div>
                        <div class="step-card">
                            <div class="step-number">3</div>
                            <p>Select the supplier and destination warehouse</p>
                        </div>
                        <div class="step-card">
                            <div class="step-number">4</div>
                            <p>Set dispatch date and expected arrival date</p>
                        </div>
                        <div class="step-card">
                            <div class="step-number">5</div>
                            <p>Choose priority level and add any special instructions</p>
                        </div>
                        
                        <h3><i class="bi bi-list-check"></i>Cargo Status Definitions</h3>
                        <div class="table-responsive">
                            <table class="table table-bordered">
                                <thead class="table-light">
                                    <tr>
                                        <th>Status</th>
                                        <th>Description</th>
                                        <th>Actions Required</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><span class="badge badge-warning">DISPATCHED</span></td>
                                        <td>Cargo has left the supplier</td>
                                        <td>Monitor for transit updates</td>
                                    </tr>
                                    <tr>
                                        <td><span class="badge badge-info">IN_TRANSIT</span></td>
                                        <td>Cargo is en route to warehouse</td>
                                        <td>Track location and ETA</td>
                                    </tr>
                                    <tr>
                                        <td><span class="badge badge-primary">ARRIVED</span></td>
                                        <td>Cargo has arrived at warehouse</td>
                                        <td>Proceed with receiving process</td>
                                    </tr>
                                    <tr>
                                        <td><span class="badge badge-success">RECEIVED</span></td>
                                        <td>Cargo has been received and checked</td>
                                        <td>Update storage location</td>
                                    </tr>
                                    <tr>
                                        <td><span class="badge badge-danger">DELAYED</span></td>
                                        <td>Cargo is behind schedule</td>
                                        <td>Investigate and update ETA</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                
                <!-- Supplier Management Tab -->
                <div class="tab-content" id="supplier-management">
                    <div class="doc-section">
                        <h2><i class="bi bi-truck"></i>Supplier Management</h2>
                        
                        <p>Manage your supplier relationships and track performance metrics to optimize your supply chain.</p>
                        
                        <h3><i class="bi bi-graph-up"></i>Supplier Performance Metrics</h3>
                        <p>The system automatically calculates and tracks:</p>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="feature-card">
                                    <h5><i class="bi bi-clock"></i>On-Time Delivery Rate</h5>
                                    <p class="mb-0">Percentage of deliveries that arrive by the expected date</p>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="feature-card">
                                    <h5><i class="bi bi-star"></i>Reliability Score</h5>
                                    <p class="mb-0">Overall performance score based on multiple factors (0-100)</p>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="feature-card">
                                    <h5><i class="bi bi-speedometer"></i>Average Delivery Time</h5>
                                    <p class="mb-0">Mean time taken from dispatch to receipt</p>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="feature-card">
                                    <h5><i class="bi bi-exclamation-triangle"></i>Quality Issues</h5>
                                    <p class="mb-0">Track damaged goods and quality concerns</p>
                                </div>
                            </div>
                        </div>
                        
                        <h3><i class="bi bi-shield-check"></i>KRA PIN Validation</h3>
                        <p>The system validates Kenyan KRA PIN numbers using the format: <code>[AP]\d{9}[A-Z]</code></p>
                        <div class="code-block">
        Valid Examples:
        P051234567M
        A123456789K
                        </div>
                    </div>
                </div>
                
                <!-- Warehouse Management Tab -->
                <div class="tab-content" id="warehouse-management">
                    <div class="doc-section">
                        <h2><i class="bi bi-building"></i>Warehouse Management</h2>
                        
                        <p>Optimize your storage facilities with capacity tracking and utilization monitoring.</p>
                        
                        <h3><i class="bi bi-bar-chart"></i>Capacity Management</h3>
                        <p>Monitor warehouse utilization with color-coded indicators:</p>
                        
                        <div class="row">
                            <div class="col-md-4 text-center">
                                <div class="capacity-bar mx-auto mb-2" style="width: 100px;">
                                    <div class="capacity-fill capacity-low" style="width: 40%;"></div>
                                </div>
                                <small><strong>Low</strong> (&lt;60%) - Optimal</small>
                            </div>
                            <div class="col-md-4 text-center">
                                <div class="capacity-bar mx-auto mb-2" style="width: 100px;">
                                    <div class="capacity-fill capacity-medium" style="width: 75%;"></div>
                                </div>
                                <small><strong>Medium</strong> (60-85%) - Monitor</small>
                            </div>
                            <div class="col-md-4 text-center">
                                <div class="capacity-bar mx-auto mb-2" style="width: 100px;">
                                    <div class="capacity-fill capacity-high" style="width: 95%;"></div>
                                </div>
                                <small><strong>High</strong> (&gt;85%) - Critical</small>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Reports & Analytics Tab -->
                <div class="tab-content" id="reports-analytics">
                    <div class="doc-section">
                        <h2><i class="bi bi-graph-up"></i>Reports & Analytics</h2>
                        
                        <p>Generate comprehensive reports for management insights and decision making.</p>
                        
                        <h3><i class="bi bi-file-text"></i>Available Reports</h3>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="feature-card">
                                    <h5><i class="bi bi-truck"></i>Supplier Performance Report</h5>
                                    <p class="mb-0">Detailed analysis of supplier delivery performance and reliability</p>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="feature-card">
                                    <h5><i class="bi bi-box-seam"></i>Cargo Movement Report</h5>
                                    <p class="mb-0">Tracking of all cargo shipments within a date range</p>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="feature-card">
                                    <h5><i class="bi bi-building"></i>Inventory Summary</h5>
                                    <p class="mb-0">Current stock levels across all warehouses</p>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="feature-card">
                                    <h5><i class="bi bi-clock"></i>Delivery Analysis</h5>
                                    <p class="mb-0">Analysis of delivery times and delay patterns</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Support Contact -->
                <div class="contact-support">
                    <h4><i class="bi bi-headset me-2"></i>Need More Help?</h4>
                    <p class="mb-3">Our support team is available to assist you with any questions or issues.</p>
                    <div class="row">
                        <div class="col-md-4">
                            <i class="bi bi-envelope fs-1 text-primary mb-2"></i>
                            <h6>Email Support</h6>
                            <small>support@cargotracking.com</small>
                        </div>
                        <div class="col-md-4">
                            <i class="bi bi-telephone fs-1 text-primary mb-2"></i>
                            <h6>Phone Support</h6>
                            <small>+254 700 123 456</small>
                        </div>
                        <div class="col-md-4">
                            <i class="bi bi-clock fs-1 text-primary mb-2"></i>
                            <h6>Support Hours</h6>
                            <small>Mon-Fri: 8AM-6PM EAT</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Tab functionality
        const tabButtons = document.querySelectorAll('.tab-vertical');
        const tabContents = document.querySelectorAll('.tab-content');
        const quickLinks = document.querySelectorAll('.quick-link-card[data-tab]');

        function switchTab(tabId) {
            // Hide all tab contents
            tabContents.forEach(content => {
                content.classList.remove('active');
            });

            // Remove active class from all tab buttons
            tabButtons.forEach(button => {
                button.classList.remove('active');
            });

            // Show selected tab content
            const selectedTab = document.getElementById(tabId);
            if (selectedTab) {
                selectedTab.classList.add('active');
            }

            // Activate corresponding tab button
            const correspondingButton = document.querySelector(`.tab-vertical[data-tab="${tabId}"]`);
            if (correspondingButton) {
                correspondingButton.classList.add('active');
            }
        }

        // Add click event to tab buttons
        tabButtons.forEach(button => {
            button.addEventListener('click', function() {
                const tabId = this.getAttribute('data-tab');
                switchTab(tabId);
            });
        });

        // Add click event to quick links
        quickLinks.forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                const tabId = this.getAttribute('data-tab');
                switchTab(tabId);
            });
        });

        // Search functionality
        const searchInput = document.getElementById('docSearch');
        
        searchInput.addEventListener('input', function() {
            const searchTerm = this.value.toLowerCase();
            const tabContents = document.querySelectorAll('.tab-content');
            let foundMatch = false;
            
            tabContents.forEach(content => {
                const contentText = content.textContent.toLowerCase();
                if (contentText.includes(searchTerm)) {
                    // Show this tab and switch to it
                    const tabId = content.id;
                    switchTab(tabId);
                    foundMatch = true;
                    
                    // Highlight matching text (simplified)
                    const elements = content.querySelectorAll('p, li, h3, h5');
                    elements.forEach(el => {
                        const text = el.textContent.toLowerCase();
                        if (text.includes(searchTerm)) {
                            el.style.backgroundColor = 'rgba(255, 255, 0, 0.2)';
                        } else {
                            el.style.backgroundColor = '';
                        }
                    });
                }
            });
            
            if (!foundMatch && searchTerm.length > 0) {
                // Show no results message
                const noResults = document.createElement('div');
                noResults.className = 'alert alert-info mt-3';
                noResults.innerHTML = `No results found for "<strong>${searchTerm}</strong>". Try different keywords.`;
                
                // Remove existing no results message
                const existingNoResults = document.querySelector('.alert-info');
                if (existingNoResults) {
                    existingNoResults.remove();
                }
                
                document.querySelector('.doc-content').appendChild(noResults);
            } else {
                // Remove no results message if it exists
                const existingNoResults = document.querySelector('.alert-info');
                if (existingNoResults) {
                    existingNoResults.remove();
                }
            }
        });

        // Clear highlights when search is cleared
        searchInput.addEventListener('search', function() {
            if (this.value === '') {
                const highlightedElements = document.querySelectorAll('[style*="background-color"]');
                highlightedElements.forEach(el => {
                    el.style.backgroundColor = '';
                });
                
                const existingNoResults = document.querySelector('.alert-info');
                if (existingNoResults) {
                    existingNoResults.remove();
                }
            }
        });
    });
</script>
{% endblock %}